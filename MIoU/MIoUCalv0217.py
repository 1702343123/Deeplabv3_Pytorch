import numpy as np
from MIoUData import MIoU_dataloader
class Evaluator(object):
    def __init__(self, num_class):
        self.num_class = num_class
        self.confusion_matrix = np.zeros((self.num_class,)*2)

    def Pixel_Accuracy(self):
        Acc = np.diag(self.confusion_matrix).sum() / self.confusion_matrix.sum()
        return Acc

    def Pixel_Accuracy_Class(self):
        Acc = np.diag(self.confusion_matrix) / self.confusion_matrix.sum(axis=1)
        Acc = np.nanmean(Acc)
        return Acc

    def Mean_Intersection_over_Union(self):
        MIoU = np.diag(self.confusion_matrix) / (
                    np.sum(self.confusion_matrix, axis=1) + np.sum(self.confusion_matrix, axis=0) -
                    np.diag(self.confusion_matrix))
        MIoU = np.nanmean(MIoU)
        return MIoU

    def Frequency_Weighted_Intersection_over_Union(self):
        freq = np.sum(self.confusion_matrix, axis=1) / np.sum(self.confusion_matrix)
        iu = np.diag(self.confusion_matrix) / (
                    np.sum(self.confusion_matrix, axis=1) + np.sum(self.confusion_matrix, axis=0) -
                    np.diag(self.confusion_matrix))

        FWIoU = (freq[freq > 0] * iu[freq > 0]).sum()
        return FWIoU

    def _generate_matrix(self, gt_image, pre_image):
        mask = (gt_image >= 0) & (gt_image < self.num_class)
        label = self.num_class * gt_image[mask].astype('int') + pre_image[mask]
        count = np.bincount(label, minlength=self.num_class**2)
        confusion_matrix = count.reshape(self.num_class, self.num_class)
        return confusion_matrix

    def add_batch(self, gt_image, pre_image):
        assert gt_image.shape == pre_image.shape
        self.confusion_matrix += self._generate_matrix(gt_image, pre_image)

    def reset(self):
        self.confusion_matrix = np.zeros((self.num_class,) * 2)

if __name__ == "__main__":
    miou = Evaluator(4)
    #y_true = np.array([2, 0, 2, 2, 0, 1])
    #y_pred = np.array([0, 0, 2, 2, 0, 2])
    #cm = miou._fast_hist(y_pred, y_true)
    # batch=1，每1个算一个miou，最后求平均miou
    miouVal = 0
    accVal = 0
    for index, (predict, label) in enumerate(MIoU_dataloader):
        predict = predict.cpu().numpy()
        label = label.cpu().numpy()
        miou.add_batch(label,predict)
        accVal += miou.Pixel_Accuracy()
        miouVal += miou.Mean_Intersection_over_Union()
        print('acc and miou are {},{}'.format(miou.Pixel_Accuracy(),miou.Mean_Intersection_over_Union()))
    print('all acc and miou are {},{}'.format(accVal/len(MIoU_dataloader),miouVal/len(MIoU_dataloader)))
    
    
'''
acc and miou are 0.9870458984375,0.9302021557086269
acc and miou are 0.9806640625,0.9078004823205861
acc and miou are 0.9787736002604167,0.9028668439141987
acc and miou are 0.98227783203125,0.921201329849495
acc and miou are 0.98235498046875,0.922319352742494
acc and miou are 0.98313720703125,0.9208165388840247
acc and miou are 0.9825442940848215,0.9221935149534395
acc and miou are 0.9825979614257813,0.9216962745642575
acc and miou are 0.9836200629340278,0.9295431627914406
acc and miou are 0.985258056640625,0.9302701376250756
acc and miou are 0.9825767933238636,0.9287111962645168
acc and miou are 0.9829762776692709,0.9294700680533727
acc and miou are 0.9831424654447115,0.928881740702546
acc and miou are 0.9843465750558036,0.9294208899213192
acc and miou are 0.9848484700520833,0.9292521233154647
acc and miou are 0.9857954406738281,0.9296518143779271
acc and miou are 0.9866310029871324,0.9299919894725778
acc and miou are 0.9873737250434028,0.9302850207904407
acc and miou are 0.9875930304276316,0.9308618126676633
acc and miou are 0.987444091796875,0.9311989472631251
acc and miou are 0.9880419921875,0.9314340763927668
acc and miou are 0.9881201171875,0.9318776498413697
acc and miou are 0.9881063179347827,0.9316878423448938
acc and miou are 0.9885935465494792,0.9318298014344683
acc and miou are 0.98873291015625,0.9319479096221183
acc and miou are 0.9880270620492788,0.9305309148709793
acc and miou are 0.9878038194444444,0.9316842738086845
acc and miou are 0.9882393973214286,0.9318516752034229
acc and miou are 0.9886449353448276,0.9320048484051706
acc and miou are 0.9889475911458333,0.9319666391300726
acc and miou are 0.9890084740423387,0.9322466746765191
acc and miou are 0.9889835357666016,0.9319921698773863
acc and miou are 0.9890425988399622,0.9334320140402916
acc and miou are 0.9889629767922794,0.9328450890413488
acc and miou are 0.9888677455357143,0.9343277599715435
acc and miou are 0.9890999348958334,0.9350816780533013
acc and miou are 0.9893942673141892,0.9351878022693001
acc and miou are 0.9892580052425987,0.9354173583024201
acc and miou are 0.9817347130408653,0.9154534719766323
acc and miou are 0.9821448974609375,0.9154826317301714
acc and miou are 0.9823038538490854,0.9156526160857976
acc and miou are 0.9823173014322917,0.916717031747218
acc and miou are 0.9824088730922965,0.9169348728343865
acc and miou are 0.982808671431108,0.9170826632347383
acc and miou are 0.9828661566840278,0.9164374412697853
acc and miou are 0.982890625,0.9147270929124769
acc and miou are 0.9828768596243351,0.9159746024820108
acc and miou are 0.9830469767252604,0.9167506174849569
acc and miou are 0.9833929567920918,0.9168762854886773
acc and miou are 0.98372509765625,0.9169958969048357
acc and miou are 0.9835699582567402,0.9177124555144822
acc and miou are 0.9838408484825721,0.917717116785461
acc and miou are 0.9841457381338443,0.9178252904069633
acc and miou are 0.9836605269820602,0.9178620741483111
acc and miou are 0.9838416193181818,0.9179410892903018
acc and miou are 0.9840173775809152,0.918565132849347
acc and miou are 0.9838754968475877,0.9180126223757844
acc and miou are 0.983972967739763,0.9196674833563397
acc and miou are 0.9839262364274365,0.9206006166622945
acc and miou are 0.9841941324869792,0.9206967995003406
acc and miou are 0.9844532450691599,0.9207891995511253
acc and miou are 0.9847039991809475,0.9208780356715168
acc and miou are 0.9849467928447421,0.9209635101549105
acc and miou are 0.9850271224975586,0.9215285543654212
acc and miou are 0.9848783804086538,0.9229341147233158
acc and miou are 0.9851074958570076,0.923015324765409
acc and miou are 0.9853070341651119,0.923251106363588
acc and miou are 0.9851296099494485,0.9236013552439132
acc and miou are 0.9853451228487319,0.9236779374410691
acc and miou are 0.9854306989397321,0.9245887144904713
acc and miou are 0.9853675863776409,0.9243759425481917
acc and miou are 0.9853224012586805,0.9245296611729474
acc and miou are 0.985523464255137,0.9246014236597453
acc and miou are 0.9856148714632601,0.9250890509246967
acc and miou are 0.9858066731770834,0.925157396705276
acc and miou are 0.985962845651727,0.9251885955489688
acc and miou are 0.9859695236404221,0.9253174298509913
acc and miou are 0.9858432241586539,0.9260882384313431
acc and miou are 0.9858959342859969,0.9261311507257453
acc and miou are 0.9859297790527344,0.925778797051038
acc and miou are 0.9860032974054784,0.9264528203629879
acc and miou are 0.9861112268959603,0.9265924862043331
acc and miou are 0.9862785615116717,0.9266521032438545
acc and miou are 0.9863709368024554,0.9270318806901446
acc and miou are 0.98641845703125,0.9268667603408828
acc and miou are 0.9864655534611192,0.9278603738284191
acc and miou are 0.9863962318157328,0.9281561907565141
acc and miou are 0.9861662708629262,0.927655099004075
acc and miou are 0.9860577323999298,0.9274659953404647
acc and miou are 0.9861838650173611,0.9274360089516838
acc and miou are 0.9863127253605769,0.9274225398371256
acc and miou are 0.9863572626528533,0.9280462785260103
acc and miou are 0.9863436659946236,0.9285035170123929
acc and miou are 0.9864498316988032,0.9285573885812592
acc and miou are 0.9865333830180921,0.9286938296112067
acc and miou are 0.9865020243326823,0.9289981921225645
acc and miou are 0.9866078044458763,0.928958733646908
acc and miou are 0.9866780931122449,0.9291549498741863
acc and miou are 0.9866110815183081,0.9289562081719409
acc and miou are 0.9867363525390624,0.9289320815882149
acc and miou are 0.9866906133972773,0.9287063436190504
acc and miou are 0.9868210975796569,0.9287533458493902
acc and miou are 0.9869490480885922,0.9287992501533029
acc and miou are 0.9869823749248798,0.9286812597387688
acc and miou are 0.9869745628720238,0.9285648623681879
acc and miou are 0.9869013717939269,0.9286630306280865
acc and miou are 0.9869357385367991,0.9287541107349604
acc and miou are 0.9869361707899306,0.9286089105554558
acc and miou are 0.9869762623638189,0.9285096254568943
acc and miou are 0.9870946599786932,0.9285517321143795
acc and miou are 0.987137110254786,0.9292225087941434
acc and miou are 0.987251957484654,0.9292635163385023
acc and miou are 0.9871823147123894,0.9293472199135233
acc and miou are 0.9871842233758223,0.929350984659382
acc and miou are 0.9872007048233695,0.9295706402616079
acc and miou are 0.9871304847454203,0.9293210939512169
acc and miou are 0.9871206638955662,0.9295202579399734
acc and miou are 0.9871265889830508,0.9298161672071936
acc and miou are 0.9871941882221639,0.9299644246390129
acc and miou are 0.9873009033203125,0.9300026418408445
acc and miou are 0.9871368559529958,0.9298463444703419
acc and miou are 0.9870993692366803,0.9299345765636156
acc and miou are 0.9869819256542175,0.9304090754941834
acc and miou are 0.9869693288495464,0.9304518027839895
acc and miou are 0.98707357421875,0.9304892096628676
acc and miou are 0.9869936794704861,0.9305265583322442
acc and miou are 0.9870960914431595,0.9305633875000057
acc and miou are 0.987010726928711,0.9306181229452875
acc and miou are 0.9870582568737888,0.9310183257189724
acc and miou are 0.9870052771935096,0.9308367089509664
acc and miou are 0.9869817509541985,0.9314288556995817
acc and miou are 0.9870803740530303,0.9314647566581873
acc and miou are 0.9870880264626409,0.9319726276539753
acc and miou are 0.9870619679920709,0.9321921668936507
acc and miou are 0.9870679072627315,0.9323535934993137
acc and miou are 0.9870073206284466,0.9321744556369144
acc and miou are 0.9870823591468978,0.9321951703329048
acc and miou are 0.9871547002377717,0.9321711467446848
acc and miou are 0.9871994260060701,0.9321212165288992
acc and miou are 0.9872216971261161,0.9322430114477859
acc and miou are 0.9872863336657801,0.9327033141342157
acc and miou are 0.9873531717649648,0.9327317021280424
acc and miou are 0.9874416111232518,0.9327642562846377
acc and miou are 0.987528822157118,0.9327962581969744
acc and miou are 0.9875591998922414,0.9330741236370895
acc and miou are 0.9876444108518836,0.9331053787620877
acc and miou are 0.9877284624787415,0.9331361154014902
acc and miou are 0.9877966638513513,0.9331247288723215
acc and miou are 0.9878651786650587,0.9331470389723767
acc and miou are 0.9878238606770834,0.9330397872382838
acc and miou are 0.9878951197744206,0.9330451640746174
acc and miou are 0.9878862401058799,0.9329959333780069
acc and miou are 0.9879654150071487,0.9330245068951446
acc and miou are 0.9879266278155439,0.9330076829155426
acc and miou are 0.9879312626008064,0.9328409193657454
acc and miou are 0.9880086263020833,0.932868708818706
acc and miou are 0.9879959631269905,0.933285414190675
acc and miou are 0.9879702488380142,0.9331197430535434
acc and miou are 0.987925234620676,0.9327993989116318
acc and miou are 0.9879165954589844,0.9326083733454619
acc and miou are 0.9879916476611025,0.9326353778551768
acc and miou are 0.9879139992042824,0.9321723339496064
acc and miou are 0.9879464628067485,0.9320908996771808
acc and miou are 0.9879333198361281,0.9321095193544292
acc and miou are 0.9880064512310606,0.9321356513364695
acc and miou are 0.9880439041321536,0.9321565899925989
acc and miou are 0.9881154975205838,0.9321820868372911
acc and miou are 0.9881168474469866,0.9319940511207431
acc and miou are 0.988163137943787,0.9322343145116544
acc and miou are 0.9881648523667279,0.9324707789373321
acc and miou are 0.9882148180509869,0.9324212957818128
acc and miou are 0.9881433247410973,0.9322188695100397
acc and miou are 0.9881465634031792,0.9326457804494798
acc and miou are 0.9881447136539152,0.9325510432378761
acc and miou are 0.98813505859375,0.9328350130895479
acc and miou are 0.9881356117942116,0.9326735810654323
acc and miou are 0.9881874006885594,0.9327002933931223
acc and miou are 0.9881971449262641,0.9326754133797428
acc and miou are 0.9881929229224861,0.9326892960294377
acc and miou are 0.9882396375868056,0.9334260450274317
acc and miou are 0.9881697411300069,0.9335178496835203
acc and miou are 0.9882347425523695,0.9335412068460539
acc and miou are 0.9882300738558744,0.9336760962567229
acc and miou are 0.9882940408457881,0.9336990863897656
acc and miou are 0.9883573163006757,0.9337217767565491
acc and miou are 0.9884199113743279,0.9337441731820355
acc and miou are 0.9884818369819519,0.9337662813412394
acc and miou are 0.9885254165974069,0.9337913796677424
acc and miou are 0.9885138423859127,0.9339416300774213
acc and miou are 0.9884790810032895,0.9341157505643336
acc and miou are 0.9885393999509162,0.9341372869877522
acc and miou are 0.9885020192464192,0.9341029195506123
acc and miou are 0.9885407980488989,0.934069122691249
acc and miou are 0.9885685053559923,0.9341357997397672
acc and miou are 0.9885577924679487,0.9339826527945254
acc and miou are 0.9885299495774873,0.9340678892353416
acc and miou are 0.9885045085461611,0.9339610730582383
acc and miou are 0.9885213955965909,0.9338913033217577
acc and miou are 0.9885104477465452,0.9336934430663644
acc and miou are 0.9885678955078125,0.9337137896746561
acc and miou are 0.9886245651624689,0.9337320857324916
acc and miou are 0.9885487411045792,0.9334178016640176
acc and miou are 0.9885292030672722,0.9334453499823754
acc and miou are 0.9884708180147059,0.9329710352011151
acc and miou are 0.9884648556592988,0.9332299250158209
acc and miou are 0.9885208515056129,0.9332497559910691
acc and miou are 0.9885491913873792,0.9332340260342987
acc and miou are 0.9885452857384315,0.9330882470214881
acc and miou are 0.9884429201555024,0.9326526410949072
acc and miou are 0.9884979538690476,0.9326720643924896
acc and miou are 0.9885338371963862,0.9327971903132365
acc and miou are 0.9884424979731722,0.9327212521148411
acc and miou are 0.9884967585460681,0.9327404420872318
acc and miou are 0.9884739385587032,0.9327975939580757
acc and miou are 0.9884305959302325,0.9325036460724894
acc and miou are 0.9884688991970486,0.9325282660815339
acc and miou are 0.9884779463385657,0.9324630126545781
acc and miou are 0.9884711309310493,0.9323306231133657
acc and miou are 0.9884867517480023,0.9323423131996165
acc and miou are 0.9885020751953125,0.9322858731993472
acc and miou are 0.9884346940398756,0.9320427668692685
acc and miou are 0.9884516535578547,0.9321416563459273
acc and miou are 0.9885034398647702,0.9321599340757856
acc and miou are 0.9885023389543806,0.9320278964087092
acc and miou are 0.9884293185763889,0.9317012658086956
acc and miou are 0.9883780744434458,0.932066642177405
acc and miou are 0.9883439521957599,0.9319928090858242
acc and miou are 0.9883485599986294,0.9318686696031853
acc and miou are 0.9883994396492904,0.9318865869297406
acc and miou are 0.9884498768682065,0.9319043184385443
acc and miou are 0.9884996660240801,0.9319209608779997
acc and miou are 0.9884461185849946,0.9321854404908699
acc and miou are 0.9883791053346298,0.9320435698471816
acc and miou are 0.9884287672776443,0.9320610489760855
acc and miou are 0.9884126184341755,0.9321256158664974
acc and miou are 0.9884475656283104,0.9321962586073158
acc and miou are 0.9884963100771361,0.9322134179799704
acc and miou are 0.9884988018644958,0.9323984211122492
acc and miou are 0.9884989233296286,0.9323017176015787
acc and miou are 0.9885468444824219,0.9323185673862037
acc and miou are 0.9884472858856328,0.9320593400542635
acc and miou are 0.9884950243737087,0.9320760968655847
acc and miou are 0.9885423699524177,0.9320926894737289
acc and miou are 0.9884670570248463,0.9321728671633497
acc and miou are 0.988439791932398,0.9322987850200101
acc and miou are 0.9884719476467225,0.9322753265908237
acc and miou are 0.9884922290137905,0.932380711488024
acc and miou are 0.9884935046780494,0.9324967764337585
acc and miou are 0.9885096342400853,0.9325770043262258
acc and miou are 0.9885128125,0.932719031025269
acc and miou are 0.988558578187251,0.9327351349654852
acc and miou are 0.9885979837084573,0.9327365031081551
acc and miou are 0.9886430509665267,0.9327523150623758
acc and miou are 0.9886785167784202,0.932740498868139
acc and miou are 0.9887229147518383,0.9327560293699584
acc and miou are 0.9887632369995117,0.9327739691220991
acc and miou are 0.9888069598127431,0.9327892214418179
acc and miou are 0.9887386730105377,0.9331770611162988
acc and miou are 0.9887821530375241,0.933192218427737
acc and miou are 0.9887659442608173,0.9331512691299582
acc and miou are 0.9887382793791906,0.9331940221835822
acc and miou are 0.9887777873031965,0.9332062142142847
acc and miou are 0.9887386191480513,0.9329820275776806
acc and miou are 0.9887812758937027,0.932996882629805
acc and miou are 0.9887200766509434,0.9330725289116242
acc and miou are 0.9887624823778195,0.9330873118168685
acc and miou are 0.9887378112564372,0.9330027312500894
acc and miou are 0.9887267793114506,0.9328637237491534
acc and miou are 0.9887645849064823,0.9328737211642837
acc and miou are 0.9887693956163195,0.9327855044749243
acc and miou are 0.9887703690757611,0.932837615174422
acc and miou are 0.9888116544835708,0.9328519487151525
acc and miou are 0.9887904754750458,0.9327665208692281
acc and miou are 0.9888302456375456,0.9327782926142764
acc and miou are 0.9887457475142045,0.932274237949877
acc and miou are 0.9887421008123868,0.9323178340536981
acc and miou are 0.9887443415782943,0.9322213346447865
acc and miou are 0.9887400411701889,0.932203294995031
acc and miou are 0.9887398843525985,0.932273995751998
acc and miou are 0.9887800990513392,0.9322879155269004
acc and miou are 0.9887673591803826,0.9323731396966608
acc and miou are 0.9887755395334663,0.9323649837152517
acc and miou are 0.988797628989068,0.9323325393901626
acc and miou are 0.9888143791950924,0.9324560001855502
acc and miou are 0.9888039679276316,0.9323847818595128
acc and miou are 0.9888032072907561,0.9323909009396921
acc and miou are 0.9887924821700784,0.9327031335077294
acc and miou are 0.9887281460232205,0.9324444544811693
acc and miou are 0.9886818180282223,0.9327318054108441
acc and miou are 0.9886541369207974,0.9326230278857117
acc and miou are 0.9886931261410009,0.9326365561286123
acc and miou are 0.9887318483117509,0.9326499746095094
acc and miou are 0.988755624400064,0.9326471185251729
acc and miou are 0.9887631703071854,0.932570322135655
acc and miou are 0.9887533600370763,0.9327064411483339
acc and miou are 0.9887913554423564,0.9327195980244508
acc and miou are 0.9888115201494108,0.9327561438678539
acc and miou are 0.9888231930316694,0.932685155678733
acc and miou are 0.9888010082436246,0.9326383829497238
acc and miou are 0.9888383382161459,0.9326512858207001
acc and miou are 0.9888717215401785,0.9326489452260068
acc and miou are 0.9889085701443502,0.9326616511202168
acc and miou are 0.9889385120152641,0.9326481790392436
acc and miou are 0.9889185774953742,0.9326814631845064
acc and miou are 0.9888863185194672,0.9326793683565224
acc and miou are 0.9889226377399918,0.9326919052868197
acc and miou are 0.988917987835912,0.9329317225926567
acc and miou are 0.9888983233563312,0.9328493287252859
acc and miou are 0.9889289021414847,0.9328571559140314
acc and miou are 0.988964615360383,0.9328694937969196
acc and miou are 0.9889042796046021,0.9326175568837061
acc and miou are 0.9889398428109976,0.9326298526257796
acc and miou are 0.9889168112270368,0.9326576580224943
acc and miou are 0.9889521080065685,0.9326698684359034
acc and miou are 0.9889441034226191,0.9326085941816589
acc and miou are 0.9889600227452532,0.9327683250262685
acc and miou are 0.9889889189422318,0.9327645524206685
acc and miou are 0.9889968737716195,0.9327491330793506
acc and miou are 0.9890139550475118,0.9327799523502787
acc and miou are 0.9890482864379883,0.932791804935061
acc and miou are 0.989021855529595,0.9328791908819096
acc and miou are 0.9890461001188858,0.9328785751089215
acc and miou are 0.9890185244533669,0.9327895531753849
acc and miou are 0.9890503984616127,0.932792702014192
acc and miou are 0.9890276742788462,0.9327839954658693
acc and miou are 0.9890128181317102,0.9328186145027269
acc and miou are 0.9889948200377485,0.9327028974854749
acc and miou are 0.9889779514219703,0.9328687294117793
acc and miou are 0.9889938660595555,0.9328989471615072
acc and miou are 0.9890272179805871,0.9329105014884372
acc and miou are 0.9890080219741314,0.9330130002384933
acc and miou are 0.9889915889142508,0.9328620299971031
acc and miou are 0.9890060323995871,0.9328744641017657
acc and miou are 0.9888933485567927,0.9321380639981729
acc and miou are 0.9888821055853545,0.9320268453246767
acc and miou are 0.9888593255905878,0.9320931433444115
acc and miou are 0.9888923839716246,0.9321045856133205
acc and miou are 0.9889116167598927,0.9321761969275013
acc and miou are 0.9889265014288348,0.9322259615505986
acc and miou are 0.9888929658777573,0.9324502204613596
acc and miou are 0.9889255378253299,0.932461491679347
acc and miou are 0.9889579192936769,0.9324726849199416
acc and miou are 0.9889200514190051,0.9324269035222179
acc and miou are 0.9889522605718568,0.9324380403481805
acc and miou are 0.9889842830049819,0.93244910082919
acc and miou are 0.9890161203373374,0.9324600857476026
acc and miou are 0.988912919893732,0.9321079861435214
acc and miou are 0.988917236328125,0.9320820205155078
acc and miou are 0.9889361834594377,0.9321108897353795
acc and miou are 0.9889408272879464,0.932097578416916
acc and miou are 0.9889585906895477,0.9321648941720057
acc and miou are 0.9889448339288885,0.9323268681478663
acc and miou are 0.9889175440974681,0.9322347430433975
acc and miou are 0.9889353330795374,0.9322979239007365
acc and miou are 0.9888894833846831,0.9324335907421062
acc and miou are 0.9889206927010182,0.9324443976481092
acc and miou are 0.9889222661720939,0.9323968670301463
acc and miou are 0.9888210121879365,0.9321071557579266
acc and miou are 0.9888521514297528,0.9321179189435203
acc and miou are 0.9888831176757813,0.9321286114518188
acc and miou are 0.9888595048476454,0.9319888945706385
acc and miou are 0.9888117298105145,0.9317435974266103
acc and miou are 0.9888424909607438,0.9317536701305138
acc and miou are 0.9888574621179602,0.9317879170284091
acc and miou are 0.988865287885274,0.9318147943652566
acc and miou are 0.9888670807718579,0.9319024036383956
acc and miou are 0.9888974157016349,0.9319128582674945
acc and miou are 0.9888589742909307,0.9318646631897893
acc and miou are 0.9888891667725271,0.9318750710005379
acc and miou are 0.9889191960515202,0.9318854124120792
acc and miou are 0.9889360272595182,0.9318583282614836
acc and miou are 0.9889657691217237,0.9318685519075827
acc and miou are 0.9889953515101374,0.9318787109446516
acc and miou are 0.9890247757039605,0.9318888059832131
acc and miou are 0.9890171614583333,0.9319590115433425
acc and miou are 0.9890463711353058,0.9319690385605828
acc and miou are 0.9890211450389589,0.9320574454440334
acc and miou are 0.9890456878823578,0.9320505102862191
acc and miou are 0.9890745910805574,0.9320604192237862
acc and miou are 0.9890748098273027,0.9321575825992953
acc and miou are 0.989103484867126,0.9321674173339639
acc and miou are 0.9891320097758508,0.9321771914363578
acc and miou are 0.9891535969627121,0.9321734115550986
acc and miou are 0.989181842803955,0.9321830738113416
acc and miou are 0.9891939808238637,0.9322187273635419
acc and miou are 0.9892219756921956,0.9322282975903619
acc and miou are 0.9892040258599806,0.9322154637078524
acc and miou are 0.9891696324299292,0.9319798291260755
acc and miou are 0.9891965639560572,0.9319864965332076
acc and miou are 0.9892242650741185,0.9319959493873501
acc and miou are 0.9892305324388587,0.9321879531138917
acc and miou are 0.9892580055703922,0.9321973434067827
acc and miou are 0.9892629997117526,0.9323352333911993
acc and miou are 0.9892902509815197,0.9323445555348843
acc and miou are 0.9893123763844937,0.9323401273579995
acc and miou are 0.9892947233566131,0.9322771874683123
acc and miou are 0.9893216887889641,0.9322863957283122
acc and miou are 0.9892872688638505,0.93211240225521
acc and miou are 0.9892945988016917,0.9320627661903175
acc and miou are 0.9892467407226563,0.9319588155869329
acc and miou are 0.9892617090087282,0.9319419659929823
acc and miou are 0.9892605393442941,0.9319727723029001
acc and miou are 0.9892433155145006,0.9318920265299918
acc and miou are 0.9892561083500928,0.9320117342694015
acc and miou are 0.9892334587191358,0.93198798423844
acc and miou are 0.9892599772937192,0.9319970529161486
acc and miou are 0.9892863655558968,0.9320060692068758
acc and miou are 0.9892916391410079,0.931989368319249
acc and miou are 0.9892818803484108,0.9319128304522656
acc and miou are 0.9892833639005335,0.9319363323158244
acc and miou are 0.9892969403417731,0.9319694031143316
acc and miou are 0.9892938647223908,0.9318407203700755
acc and miou are 0.9893197875680992,0.93184955893125
acc and miou are 0.989345520314387,0.931858144092549
acc and miou are 0.9893461325771837,0.9319528589609107
acc and miou are 0.9893458439753606,0.9318839785743727
acc and miou are 0.9893494149992506,0.9318666985378861
acc and miou are 0.9892998829526765,0.9317006233067969
acc and miou are 0.989281737115901,0.9316989501236608
acc and miou are 0.9892693801153274,0.931834614092101
acc and miou are 0.9892564381216598,0.932001647774716
acc and miou are 0.9892662417154177,0.9320374170466159
acc and miou are 0.9892896893007536,0.9320368448465783
acc and miou are 0.9893149494674971,0.9320454759482171
acc and miou are 0.9893400907628677,0.9320540593312194
acc and miou are 0.9893325160926496,0.9322192313956732
acc and miou are 0.9893406716554449,0.9322583181307156
acc and miou are 0.9893655766282126,0.9322668243060588
acc and miou are 0.9893903654938812,0.9322752839025673
acc and miou are 0.9893818643259448,0.932216114863396
acc and miou are 0.989363195149362,0.9322293385657303
acc and miou are 0.9893878173828125,0.9322377286726266
all acc and miou are 0.9878058596007321,0.9306004317843026
'''
